# Production security headers and policies
# Based on CONFIGURATION.md security requirements

# Remove server information
server_tokens off;
more_clear_headers 'Server';
more_clear_headers 'X-Powered-By';

# CORS configuration for API endpoints
map $request_method $cors_method {
    OPTIONS 1;
    default 0;
}

map $http_origin $cors_origin {
    default 0;
    "~^https?://(localhost|127\.0\.0\.1)(:[0-9]+)?$" 1;
    "~^https?://.*\.yourdomain\.com$" 1;
}
